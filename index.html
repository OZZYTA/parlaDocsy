<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interfaz de Usuario</title>
</head>
<body>
    <button id="startButton">Iniciar Escucha</button>
    <button id="stopButton" style="display: none;">Detener Escucha</button>
    <div id="response"></div>

    <script>
        const startButton = document.getElementById("startButton");
        const stopButton = document.getElementById("stopButton");
        const responseDiv = document.getElementById("response");

        startButton.addEventListener("click", () => {
            startButton.style.display = "none";
            stopButton.style.display = "block";

            // Iniciar la grabación de audio y enviarlo al servidor
            // Aquí puedes usar WebSockets o hacer una solicitud AJAX al servidor Flask
            // Para este ejemplo, usaré una solicitud AJAX básica
            const xhr = new XMLHttpRequest();
            xhr.open("POST", "/process_audio");
            xhr.setRequestHeader("Content-Type", "application/json");
            xhr.onload = () => {
                if (xhr.status === 200) {
                    const response = JSON.parse(xhr.responseText);
                    responseDiv.textContent = response;
                }
            };
            xhr.send(JSON.stringify({ prompt: "Iniciando escucha..." }));
        });

        stopButton.addEventListener("click", () => {
            startButton.style.display = "block";
            stopButton.style.display = "none";

            // Detener la grabación de audio y enviar la señal de finalización al servidor
            const xhr = new XMLHttpRequest();
            xhr.open("POST", "/process_audio");
            xhr.setRequestHeader("Content-Type", "application/json");
            xhr.onload = () => {
                if (xhr.status === 200) {
                    const response = JSON.parse(xhr.responseText);
                    responseDiv.textContent = response;
                }
            };
            xhr.send(JSON.stringify({ prompt: "Fin de atención" }));
        });
    </script>
</body>
</html>
